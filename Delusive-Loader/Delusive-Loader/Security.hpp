__forceinline auto HideProcess() -> void
{
	HANDLE hProcess = NULL;
	DEBUG_EVENT de;
	PROCESS_INFORMATION pi;
	STARTUPINFO si;
	ZeroMemory(&pi, sizeof(PROCESS_INFORMATION));
	ZeroMemory(&si, sizeof(STARTUPINFO));
	ZeroMemory(&de, sizeof(DEBUG_EVENT));

	GetStartupInfo(&si);

	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);
	CreateProcess(NULL, GetCommandLine(), NULL, NULL, FALSE, CREATE_SECURE_PROCESS, NULL, NULL, &si, &pi);

	ContinueDebugEvent(pi.dwProcessId, pi.dwThreadId, DBG_TERMINATE_PROCESS);

	WaitForDebugEvent(&de, INFINITE);
}

__forceinline auto isProcessRunning(const std::wstring& processName) -> bool
{
	HANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
	PROCESSENTRY32 pe;
	pe.dwSize = sizeof(PROCESSENTRY32);

	if (Process32First(hSnapshot, &pe)) {
		do {
			if (wcscmp(pe.szExeFile, processName.c_str()) == 0) {
				CloseHandle(hSnapshot);
				return true;
			}
		} while (Process32Next(hSnapshot, &pe));
	}
	CloseHandle(hSnapshot);
	return false;
}

__forceinline auto AntiDebug() -> void
{
	BOOL isDebuggerPresent = FALSE;
	CheckRemoteDebuggerPresent(GetCurrentProcess(), &isDebuggerPresent);

	if (isDebuggerPresent) {
		Loader::UI.SetColor(Red, Black);
		std::cout << "[-] Debugger detected!" << std::endl;
		std::this_thread::sleep_for(std::chrono::seconds(1));
		exit(1);
	}
}

__forceinline auto ProcessSecurity() -> void {
	while (true) {
		if (isProcessRunning(L"ida64.exe") ||
			isProcessRunning(L"idaq.exe") ||
			isProcessRunning(L"ghidraRun.bat") ||
			isProcessRunning(L"r2.exe") ||
			isProcessRunning(L"binaryninja.exe") ||
			isProcessRunning(L"ollydbg.exe") ||
			isProcessRunning(L"x64dbg.exe") ||
			isProcessRunning(L"windbg.exe") ||
			isProcessRunning(L"gdb.exe") ||
			isProcessRunning(L"lldb.exe") ||
			isProcessRunning(L"winhex.exe") ||
			isProcessRunning(L"ProcessHacker.exe") ||
			isProcessRunning(L"Cheat Engine.exe")) {
			std::system(xorstr_("cls"));
			Loader::UI.SetColor(Red, Black);
			std::cout << xorstr_("[-] Banned process detected!") << std::endl;
			std::this_thread::sleep_for(std::chrono::seconds(1));
			std::exit(1);
		}

		AntiDebug();

		std::this_thread::sleep_for(std::chrono::seconds(5));
	}
}

